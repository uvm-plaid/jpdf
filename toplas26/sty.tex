\section{Share Types}
\label{section-sty}

It is well-known that adding or subtracting a sample from a uniform
distribution in a finite field yields a value in a uniform
distribution, meaning that samples can be used as one-time-pads with
perfect secrecy \cite{barthe2019probabilistic,darais2019language}.

$$
\begin{array}{rclr}
  \sty &::=& \sharety \mid \pubty \mid \outty & \textit{share types} \\
  \stt &::=& [\phi,\phi] \mid \pubx{\phi} & \textit{share terms} 
\end{array}
$$

\stylocalfig


\begin{mathpar}
  \inferrule[Share]
      {\eqs \models \mx{z}{\cid_2} \eop \phi - \rx{y}{\cid_1} \\ \cid_1 \ne \cid_2}
      {\eqs \vdash \Gamma,R \stredx \Gamma \cup \setit{[\mx{z}{\cid_2}, \rx{y}{\cid_1}] : \sharety}, R \uplus \setit{\rx{y}{\cid_1}}}

  \inferrule[SecOpen]
      {
        \Gamma, \eqs \vdash [\px{x},\px{y}] : \sharety\\
        \eqs \models  \px{x} + \px{y} \eop \phi' - \rx{y}{\oid}
      }
      {\eqs \vdash \Gamma,R \stredx \Gamma \cup \setit{\pubx{\px{x} + \px{y}}  : \pubty}, R \uplus \setit{\rx{y}{\cid_o}}}

  \inferrule[Reveal]
      {
        \Gamma, \eqs \vdash [\px{x},\px{y}] : \sharety
      }
      {\eqs \vdash \Gamma,R \stredx \Gamma \cup \setit{\pubx{\px{x} + \px{y}}  : \outty}, R}

  \inferrule[Output]
      {
        \Gamma, \eqs \vdash \pubx{\out{\cid}} : \outty
      }
      {\eqs \vdash \Gamma,R \stredx \Gamma \uplus \setit{\pubx{\out{\cid}} : \outty}, R}
\end{mathpar}
