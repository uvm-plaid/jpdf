{\footnotesize
\begin{verbatimtab}
  owl(gid) { { k = flip[2,"gate:" || gid || ".k"]; p = flip[2,"gate:" || gid || ".p"] } }

  encode(sa, sb) {
    let owl1 = owl(sa) in
    let owl2 = owl(sb) in
    v[1,gate: || sa || 1.k] := OT(s[1,sa],owl1.k,(not owl1.k));
    v[1,gate: || sa || 1.p] := OT(s[1,sa],owl1.p,(not owl1.p));
    v[1,gate: || sb || 2.k] := select(s[2,sb],owl2.k,(not owl2.k));
    v[1,gate: || sb || 2.p] := select(s[2,sb],owl2.p,(not owl2.p));
    { wv1 = { k = v[1,"gate:" || sa || "1.k"]; p = v[1,"gate:" || sa || "1.p"] };
      wv2 = { k = v[1,"gate:" || sb || "2.k"]; p = v[1,"gate:" || sb || "2.p"] } }
  }

  andgg(g, ga, gb, wva, wvb) { andgate(g, ga, gb); evalgate(g, wva, wvb) }

  decode(g, wv) { garbledecode(wv.g); evaldecode(v) }
\end{verbatimtab}
}

{\footnotesize
\begin{verbatimtab}
  let secrets = encode("s1","s2") in v[0,output] := decode(andgg("0", secrets.wv1, secrets.wv2)) \end{verbatimtab}
}

{\footnotesize
\begin{verbatimtab}
  owl    :   string(gid)
  
  encode :   string(sa) * string(sb)
  
  andgg  :  string(g) * { k : bool[1]; p : bool[1] } *  { k : bool[1]; p : bool[1] }

  decode :  string(g) * { k : bool[1]; p : bool[1] }
\end{verbatimtab}
}
